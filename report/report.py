from docx import Document
import docx
import os
from i18n import _
class Report():
    def __init__(self, save_path):
        # super().__init__()
        self.document = Document()
        self.path=save_path
    
    def _add_paragraph(self, text:str, style:str):
        self.document.add_paragraph(text, style=style)

    def _add_picture(self, path:str, width):
        self.document.add_picture(path, width=width)

    def _add_run(self, text:str, style='normal'):
        paragraph = self.document.add_paragraph('')
        run = paragraph.add_run(text)
        if style=='bold':
            run.bold = True
        elif style=='italic':   
            run.italic=True
        else:
            pass
        paragraph.alignment = 1

    def _save(self, new_file_name):
        completeName = os.path.join(self.path, new_file_name)
        self.document.save(completeName)

    def _add_page_break(self):
        self.document.add_page_break()

    def first_page(self):
        
        head = self.document.add_heading(_('MACHINE DIAGNOSTIC REPORT'), 0)
        head.alignment = 1
        self.document.add_heading(_('Setup'), level=1)

        p = self.document.add_paragraph('')
        p.add_run(_('Diagnostic Person:')).bold = True
        p.add_run('....................................................................................................')

        p = self.document.add_paragraph('')
        p.add_run(_('Machine type:')).bold = True
        p.add_run('...............................................................................................................')

        p = self.document.add_paragraph('')
        p.add_run(_('Power(kW):')).bold = True
        p.add_run('..........................................................')

        p = self.document.add_paragraph('')
        p.add_run(_('Speed(RPM):')).bold = True
        p.add_run('..........................................................')

        p = self.document.add_paragraph('')
        p.add_run(_('Shaft diameter:')).bold = True
        p.add_run('..........................................................')

        p = self.document.add_paragraph('')
        p.add_run(_('Measurement type:')).bold = True
        p.add_run('..........................................................')

        p = self.document.add_paragraph('')
        p.add_run(_('Sensor:')).bold = True
        p.add_run('..........................................................')

        p = self.document.add_paragraph('')
        p.add_run(_('Sensor mount:')).bold = True
        p.add_run('..........................................................')

        p = self.document.add_paragraph('')
        p.add_run(_('Sensor position:')).bold = True
        p.add_run('..........................................................')

        p = self.document.add_paragraph('')
        p.add_run(_('Bearing code:')).bold = True
        p.add_run('..........................................................')

        p = self.document.add_paragraph('')
        p.add_run(_('Shaft bore:')).bold = True
        p.add_run('..........................................................')

        p = self.document.add_paragraph('')
        p.add_run(_('Gear teeth:')).bold = True
        p.add_run('..........................................................')

        p = self.document.add_paragraph('')
        p.add_run(_('Other:')).bold = True
        p.add_run('........................................................................................................................................................')

        self.document.add_heading(_('Conclusion'), level=1)
        p = self.document.add_paragraph('')
        p.add_run('................................................................................................................................................................................................')
        p = self.document.add_paragraph('')
        p.add_run('................................................................................................................................................................................................')
        p = self.document.add_paragraph('')
        p.add_run('................................................................................................................................................................................................')
        p = self.document.add_paragraph('')
        p.add_run('................................................................................................................................................................................................')
        p = self.document.add_paragraph('')
        p.add_run('................................................................................................................................................................................................')
        p = self.document.add_paragraph('')
        p.add_run('................................................................................................................................................................................................')
        p = self.document.add_paragraph('')
        p.add_run('................................................................................................................................................................................................')
        p = self.document.add_paragraph('')
        p.add_run('................................................................................................................................................................................................')
        p = self.document.add_paragraph('')
        p.add_run('................................................................................................................................................................................................')
        p = self.document.add_paragraph('')
        p.add_run('................................................................................................................................................................................................')
        p = self.document.add_paragraph('')
        p.add_run('................................................................................................................................................................................................')
        p = self.document.add_paragraph('')
        p.add_run('................................................................................................................................................................................................')
        p = self.document.add_paragraph('')
        p.add_run('................................................................................................................................................................................................')
        p = self.document.add_paragraph('')
        p.add_run('................................................................................................................................................................................................')
 
        self.document.add_heading(_('Details'), level=1)

        
    def add_blank_comment(self):
        p = self.document.add_paragraph('')
        p.add_run('................................................................................................................................................................................................')
        p = self.document.add_paragraph('')
        p.add_run('................................................................................................................................................................................................')
        p = self.document.add_paragraph('')
        p.add_run('................................................................................................................................................................................................')
